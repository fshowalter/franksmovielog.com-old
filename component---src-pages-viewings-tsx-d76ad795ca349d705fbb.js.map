{"version":3,"sources":["webpack:///./src/pages/viewings.tsx","webpack:///./node_modules/use-debounce/esm/useDebouncedCallback.js"],"names":["FilterControl","Label","Container","Heading","Content","TextInput","TextInputWrap","SelectInput","SelectFilter","label","filterAttribute","children","options","key","map","optionName","optionValue","value","htmlFor","data-filter-type","data-filter-attribute","TextFilter","placeholder","state","setState","debouncedCallback","callback","delay","maxWait","maxWaitHandler","maxWaitArgs","leading","trailing","undefined","leadingCall","functionTimeoutHandler","isComponentUnmounted","debouncedFunction","current","cancelDebouncedCallback","clearTimeout","args","_i","arguments","length","apply","setTimeout","shouldCallFunction","callPending","useDebouncedCallback","str","regex","RegExp","replace","viewings","viewing","match","test","movie","title","name","onChange","e","target","Sorter","data-sorter","data-target","slugForVenue","venue","toLowerCase","FilterPanel","heading","releaseYears","year","sort","minYear","maxYear","venueOptions","Set","yearOptions","date","substring","data-filter-controls","RangeFilter","attribute","min","max","RangeFilterWrap","rangeInputMixin","RangeInputMin","RangeInputMax","data-filter-min-value","data-filter-max-value","className","style","left","type","defaultValue","step","PanelHeaderHeader","PanelHeaderHeading","PanelHeaderSlug","PanelHeader","slug","List","ListItem","ViewingListItem","React","memo","node","display","Title","Slug","moment","format","ColumnWrap","Column1","Column2","TwoColumns","Viewings","data","allViewing","nodes","ids","sequence","useState","Layout","id","imdbId","query"],"mappings":"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","file":"component---src-pages-viewings-tsx-d76ad795ca349d705fbb.js","sourcesContent":["import { graphql } from \"gatsby\";\nimport moment from \"moment\";\nimport React from \"react\";\nimport { useDebouncedCallback } from \"use-debounce\";\n\nimport { css } from \"@emotion/core\";\nimport styled from \"@emotion/styled\";\n\nimport Layout from \"../components/Layout\";\n\ninterface Viewing {\n  sequence: number;\n  date: string;\n  imdbId: string;\n  venue: string;\n  movie: {\n    sortTitle: string;\n    title: string;\n    year: string;\n  };\n}\n\ninterface Props {\n  data: {\n    allViewing: {\n      nodes: Viewing[];\n    };\n  };\n}\n\nfunction buildSlug(node: Props[\"data\"][\"allViewing\"][\"nodes\"][0]): string {\n  return `${moment(node.date).format(\"dddd MMM D, YYYY\")} via ${node.venue}.`;\n}\n\nconst FilterControl = styled.div`\n  margin-bottom: 35px;\n`;\n\nconst Label = styled.label`\n  color: #222;\n  display: block;\n  font-size: 15px;\n  font-weight: normal;\n  letter-spacing: 0.5px;\n  line-height: 2.2;\n`;\n\nconst Container = styled.div`\n  border: 1px solid #eee;\n  border-left: none;\n  border-right: none;\n  transition: opacity 0.3s ease;\n\n  @media only screen and (min-width: 48em) {\n    border: none;\n    border-right: solid 1px #eee;\n  }\n`;\n\nconst Heading = styled.h2`\n  border-bottom: 1px solid var(--color-primary);\n  display: block;\n  font-size: 19px;\n  font-weight: normal;\n  margin: 0 0 20px;\n  padding: 20px;\n  position: relative;\n  text-decoration: none;\n\n  @media only screen and (min-width: 48em) {\n    padding: 20px 0;\n  }\n`;\n\nconst Content = styled.div`\n  padding: 0 20px;\n\n  @media only screen and (min-width: 48em) {\n    padding: 0 50px 20px 0;\n  }\n`;\n\nconst TextInput = styled.input`\n  backface-visibility: hidden;\n  background-color: #fff;\n  border: 0;\n  border-radius: 0;\n  box-sizing: border-box;\n  color: var(--color-text-secondary);\n  display: block;\n  font-family: var(--font-family-system);\n  font-size: 16px;\n  padding: 0;\n  width: 100%;\n  ::placeholder {\n    color: rgba(0, 0, 0, 0.54);\n    font-family: system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\",\n      Roboto, \"Helvetica Neue\", Arial, sans-serif;\n    font-size: 14px;\n    font-weight: normal;\n  }\n`;\n\nconst TextInputWrap = styled.div`\n  border-bottom: solid 1px #eee;\n  margin-bottom: 8px;\n  padding-bottom: 7px;\n`;\n\nconst SelectInput = styled.select`\n  appearance: none;\n  backface-visibility: hidden;\n  background-color: #fff;\n  border: 0;\n  border-radius: 0;\n  box-sizing: border-box;\n  color: rgba(0, 0, 0, 0.54);\n  display: block;\n  font-family: system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto,\n    \"Helvetica Neue\", Arial, sans-serif;\n  font-size: 15px;\n  padding: 0;\n  text-indent: 0.01px;\n  text-overflow: \"\";\n  width: 100%;\n`;\n\ninterface SelectFilterProps {\n  label: string;\n  filterAttribute: string;\n  children: Array<[string, string]>;\n}\n\nfunction SelectFilter({\n  label,\n  filterAttribute,\n  children,\n}: SelectFilterProps): JSX.Element {\n  const options = [\n    <option key=\"all\">All</option>,\n    ...children.map(([optionName, optionValue]) => {\n      return (\n        <option key={optionValue} value={optionValue}>\n          {optionName}\n        </option>\n      );\n    }),\n  ];\n\n  return (\n    <FilterControl>\n      <Label htmlFor={label}>{label}</Label>\n      <SelectInput\n        data-filter-type=\"select\"\n        data-filter-attribute={filterAttribute}\n      >\n        {options}\n      </SelectInput>\n    </FilterControl>\n  );\n}\n\ninterface TextFilterProps {\n  label: string;\n  placeholder: string;\n  state: {\n    ids: number[];\n    viewings: ViewingListItem[];\n  };\n  setState(state: { ids: number[]; viewings: ViewingListItem[] }): void;\n}\n\nfunction escapeRegExp(str = \"\"): string {\n  return str.replace(/[-[\\]/{}()*+?.\\\\^$|]/g, \"\\\\$&\");\n}\n\nfunction TextFilter({\n  label,\n  placeholder,\n  state,\n  setState,\n}: TextFilterProps): JSX.Element {\n  const [debouncedCallback] = useDebouncedCallback((value: string) => {\n    const regex = new RegExp(escapeRegExp(value), \"i\");\n\n    const viewings = state.viewings.map((viewing) => {\n      return {\n        ...viewing,\n        match: regex.test(viewing.movie.title || \"\"),\n      };\n    });\n    setState({\n      ...state,\n      viewings,\n    });\n  }, 50);\n\n  return (\n    <FilterControl>\n      <Label htmlFor={label}>{label}</Label>\n      <TextInputWrap>\n        <TextInput\n          name={label}\n          placeholder={placeholder}\n          onChange={(e): void => debouncedCallback(e.target.value)}\n        />\n      </TextInputWrap>\n    </FilterControl>\n  );\n}\n\ninterface SorterProps {\n  name: string;\n  children: Array<[string, string]>;\n  target: string;\n}\n\nfunction Sorter({ name, children, target }: SorterProps): JSX.Element {\n  return (\n    <FilterControl>\n      <Label htmlFor={name}>{name}</Label>\n      <SelectInput\n        name={name}\n        data-sorter={children[0][1]}\n        data-target={target}\n      >\n        {children.map(([optionName, optionValue]) => {\n          return (\n            <option key={optionName} value={optionValue}>\n              {optionName}\n            </option>\n          );\n        })}\n      </SelectInput>\n    </FilterControl>\n  );\n}\n\nfunction slugForVenue(venue: string): string {\n  return venue\n    .toLowerCase()\n    .replace(/\\s+/g, \"-\") // Replace spaces with -\n    .replace(/&/g, \"-and-\") // Replace & with 'and'\n    .replace(/[^\\w-]+/g, \"\");\n}\n\ninterface ViewingListItem extends Viewing {\n  match: boolean;\n}\n\ninterface FilterPanelProps {\n  state: {\n    viewings: ViewingListItem[];\n    ids: number[];\n  };\n  setState(state: { ids: number[]; viewings: ViewingListItem[] }): void;\n  heading: string;\n}\n\nfunction FilterPanel({\n  state,\n  setState,\n  heading,\n}: FilterPanelProps): JSX.Element {\n  const releaseYears = state.viewings\n    .map((viewing) => {\n      return viewing.movie.year;\n    })\n    .sort();\n\n  const minYear = releaseYears[0];\n  const maxYear = releaseYears[releaseYears.length - 1];\n\n  const venues = [\n    ...new Set(\n      state.viewings.map((viewing) => {\n        return viewing.venue;\n      })\n    ),\n  ].sort();\n\n  const venueOptions = venues.map((venue): [string, string] => {\n    return [venue, slugForVenue(venue)];\n  });\n\n  const yearOptions = [\n    ...new Set(\n      state.viewings.map((viewing) => {\n        return viewing.date.substring(0, 4);\n      })\n    ),\n  ]\n    .sort()\n    .map((year): [string, string] => {\n      return [year, year];\n    });\n\n  return (\n    <Container data-filter-controls data-target=\"#viewings\">\n      <Heading>{heading}</Heading>\n      <Content>\n        <TextFilter\n          state={state}\n          setState={setState}\n          label=\"Title\"\n          placeholder=\"Enter all or part of a title.\"\n        />\n        <RangeFilter\n          name=\"Release Year\"\n          attribute=\"data-release-date\"\n          min={minYear}\n          max={maxYear}\n        />\n        <SelectFilter label=\"Viewing Year\" filterAttribute=\"data-viewing-year\">\n          {yearOptions}\n        </SelectFilter>\n        <SelectFilter label=\"Via\" filterAttribute=\"data-via\">\n          {venueOptions}\n        </SelectFilter>\n\n        <Sorter name=\"Order By\" target=\"#viewings\">\n          {[\n            [\"Viewing Date (Newest First)\", \"viewing-date-desc\"],\n            [\"Viewing Date (Oldest First)\", \"viewing-date-asc\"],\n            [\"Release Date (Newest First)\", \"release-date-desc\"],\n            [\"Release Date (Oldest First)\", \"release-date-asc\"],\n            [\"Title\", \"sort-title-asc\"],\n          ]}\n        </Sorter>\n      </Content>\n    </Container>\n  );\n}\n\nconst RangeFilterWrap = styled.div`\n  display: flex;\n  flex-flow: row wrap;\n  justify-content: space-around;\n\n  .noUi-target * {\n    background-color: rgba(0, 0, 0, 0.02);\n    box-sizing: border-box;\n    cursor: default;\n    touch-action: none;\n    -webkit-touch-callout: none;\n    transition: transform 0.3s ease-in-out;\n    user-select: none;\n  }\n\n  .noUi-active {\n    background-color: #eaeaea;\n    box-shadow: inset 0 0 5px #222;\n  }\n\n  .noUi-state-drag .noUi-active {\n    transform: scale(1.25);\n  }\n\n  .noUi-base {\n    background: rgba(0, 0, 0, 0.02);\n    border-bottom: solid 0.5rem #fff;\n    border-top: solid 0.5rem #fff;\n    height: 2rem;\n    margin: auto 0.8rem;\n    position: relative;\n\n    @media only screen and (min-width: 35em) {\n      border-color: #fff;\n    }\n  }\n\n  .noUi-handle {\n    background-color: #fff;\n    border: 1px solid rgba(0, 0, 0, 0.54);\n    border-radius: 50%;\n    height: 2rem;\n    left: -1rem;\n    position: relative;\n    top: -0.5rem;\n    width: 2rem;\n    z-index: 1;\n  }\n\n  .noUiSlider {\n    flex: 1 100%;\n  }\n\n  .noUi-origin {\n    border-radius: inherit;\n    bottom: 0;\n    position: absolute;\n    right: 0;\n    top: 0;\n  }\n\n  .noUi-stacking .noUi-handle {\n    z-index: 10;\n  }\n`;\n\nconst rangeInputMixin = css`\n  appearance: textfield;\n  background-color: #fff;\n  border: 0;\n  box-sizing: content-box;\n  color: rgba(0, 0, 0, 0.54);\n  font-family: system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto,\n    \"Helvetica Neue\", Arial, sans-serif;\n  font-size: 14px;\n  line-height: 1.2rem;\n  padding: 0;\n  width: 25%;\n\n  &::-webkit-inner-spin-button {\n    appearance: none;\n    margin: 0;\n  }\n\n  width: 3rem;\n\n  @media (min-width: 50em) {\n    height: 1.4rem;\n    line-height: 1.4rem;\n  }\n`;\n\nconst RangeInputMin = styled.input`\n  ${rangeInputMixin}\n  margin-right: auto;\n`;\n\nconst RangeInputMax = styled.input`\n  ${rangeInputMixin}\n  align-self: flex-start;\n  text-align: right;\n`;\n\ninterface RangeFilterProps {\n  name: string;\n  attribute: string;\n  min: string;\n  max: string;\n}\n\nfunction RangeFilter({\n  name,\n  attribute,\n  min,\n  max,\n}: RangeFilterProps): JSX.Element {\n  return (\n    <FilterControl>\n      <Label htmlFor={name}>{name}</Label>\n      <RangeFilterWrap\n        data-filter-attribute={attribute}\n        data-filter-type=\"range\"\n        data-filter-min-value={min}\n        data-filter-max-value={max}\n      >\n        <div className=\"noUiSlider noUi-target\">\n          <div className=\"noUi-base noUi-background noUi-horizontal\">\n            <div\n              className=\"noUi-origin noUi-origin-lower\"\n              style={{ left: \"0%\" }}\n            >\n              <div className=\"noUi-handle noUi-handle-lower\" />\n            </div>\n            <div\n              className=\"noUi-origin noUi-origin-upper\"\n              style={{ left: \"100%\" }}\n            >\n              <div className=\"noUi-handle noUi-handle-upper\" />\n            </div>\n          </div>\n        </div>\n        <RangeInputMin\n          type=\"number\"\n          defaultValue={min}\n          min={min}\n          max={max}\n          step=\"1\"\n          className=\"filter-numeric min\"\n        />\n        <RangeInputMax\n          type=\"number\"\n          defaultValue={max}\n          min={min}\n          max={max}\n          step=\"1\"\n          className=\"filter-numeric max\"\n        />\n      </RangeFilterWrap>\n    </FilterControl>\n  );\n}\n\nconst PanelHeaderHeader = styled.header`\n  padding: 20px;\n\n  @media only screen and (min-width: 48em) {\n    padding: 10px 0 20px;\n    text-align: left;\n  }\n\n  @media only screen and (min-width: 71.24em) {\n    padding-top: 0;\n  }\n`;\n\nconst PanelHeaderHeading = styled.h1`\n  line-height: 60px;\n  margin-bottom: 0;\n`;\n\nconst PanelHeaderSlug = styled.div`\n  color: rgba(0, 0, 0, 0.54);\n  font-size: 15px;\n  line-height: 20px;\n  margin-bottom: 0;\n`;\n\ninterface PanelHeaderProps {\n  title: string;\n  slug: string;\n}\n\nfunction PanelHeader({ title, slug }: PanelHeaderProps): JSX.Element {\n  return (\n    <PanelHeaderHeader>\n      <PanelHeaderHeading>{title}</PanelHeaderHeading>\n      <PanelHeaderSlug>{slug}</PanelHeaderSlug>\n    </PanelHeaderHeader>\n  );\n}\n\nconst List = styled.ol`\n  margin: 0 0 35px;\n  padding: 0;\n`;\n\nconst ListItem = styled.li`\n  font-weight: normal;\n  list-style-type: none;\n  padding: 0;\n  position: relative;\n\n  &:after {\n    background-color: #eee;\n    bottom: 0;\n    content: \"\";\n    display: block;\n    height: 1px;\n    left: 20px;\n    margin: 0;\n    position: absolute;\n    right: 0;\n  }\n`;\n\ninterface ViewingListItemProps {\n  viewing: ViewingListItem;\n}\n\nconst ViewingListItem = React.memo(function ViewingListItem({\n  viewing,\n}: ViewingListItemProps): JSX.Element {\n  const style = viewing.match ? undefined : { display: \"none\" };\n\n  return (\n    <ListItem style={style}>\n      <Title>\n        {viewing.movie.title} ({viewing.movie.year})\n      </Title>\n      <Slug>{buildSlug(viewing)}</Slug>\n    </ListItem>\n  );\n});\n\nconst Title = styled.div`\n  display: block;\n  font-size: 18px;\n  line-height: 40px;\n  overflow: hidden;\n  padding: 20px 20px 0;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n`;\n\nconst Slug = styled.div`\n  color: rgba(0, 0, 0, 0.38);\n  font-size: 15px;\n  line-height: 20px;\n  padding: 0 20px 20px;\n  text-rendering: optimizeLegibility;\n`;\n\nconst ColumnWrap = styled.div`\n  @media only screen and (min-width: 48em) {\n    border-top: solid 1px #eee;\n    display: flex;\n    margin: 0 auto;\n    width: 700px;\n  }\n  @media only screen and (min-width: 71.24em) {\n    width: 900px;\n  }\n`;\n\nconst Column1 = styled.div`\n  @media only screen and (min-width: 48em) {\n    width: 250px;\n  }\n\n  @media only screen and (min-width: 71.24em) {\n    width: 340px;\n  }\n`;\n\nconst Column2 = styled.div`\n  @media only screen and (min-width: 48em) {\n    padding-left: 30px;\n    width: 420px;\n  }\n\n  @media only screen and (min-width: 71.24em) {\n    width: 540px;\n  }\n`;\n\ninterface TwoColumnsProps {\n  children: React.ReactNode;\n}\n\nfunction TwoColumns({ children }: TwoColumnsProps): JSX.Element {\n  return <ColumnWrap>{children}</ColumnWrap>;\n}\n\nexport default function Viewings({ data }: Props): JSX.Element {\n  const viewings = data.allViewing.nodes.map((node) => {\n    return { ...node, match: true };\n  });\n\n  const ids = data.allViewing.nodes.map((node) => {\n    return node.sequence;\n  });\n\n  const [state, setState] = React.useState({ viewings, ids });\n\n  return (\n    <Layout>\n      <PanelHeader\n        title=\"Viewing Log\"\n        slug={`I've watched ${data.allViewing.nodes.length} movies since 2012`}\n      />\n      <TwoColumns>\n        <Column1>\n          <FilterPanel\n            state={state}\n            setState={setState}\n            heading=\"Filter and Sort\"\n          />\n        </Column1>\n        <Column2>\n          <List id=\"viewings\">\n            {state.viewings.map((viewing) => (\n              <ViewingListItem\n                key={`${viewing.sequence}-${viewing.imdbId}`}\n                viewing={viewing}\n              />\n            ))}\n          </List>\n        </Column2>\n      </TwoColumns>\n    </Layout>\n  );\n}\n\nexport const query = graphql`\n  query {\n    allViewing(sort: { fields: [sequence], order: DESC }) {\n      nodes {\n        sequence\n        date(formatString: \"YYYY-MM-DD\")\n        imdbId\n        venue\n        movie {\n          sortTitle\n          title\n          year\n        }\n      }\n    }\n  }\n`;\n","import { useRef, useCallback, useEffect } from 'react';\nexport default function useDebouncedCallback(callback, delay, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var maxWait = options.maxWait;\n  var maxWaitHandler = useRef(null);\n  var maxWaitArgs = useRef([]);\n  var leading = options.leading;\n  var trailing = options.trailing === undefined ? true : options.trailing;\n  var leadingCall = useRef(false);\n  var functionTimeoutHandler = useRef(null);\n  var isComponentUnmounted = useRef(false);\n  var debouncedFunction = useRef(callback);\n  debouncedFunction.current = callback;\n  var cancelDebouncedCallback = useCallback(function () {\n    clearTimeout(functionTimeoutHandler.current);\n    clearTimeout(maxWaitHandler.current);\n    maxWaitHandler.current = null;\n    maxWaitArgs.current = [];\n    functionTimeoutHandler.current = null;\n    leadingCall.current = false;\n  }, []);\n  useEffect(function () {\n    return function () {\n      // we use flag, as we allow to call callPending outside the hook\n      isComponentUnmounted.current = true;\n    };\n  }, []);\n  var debouncedCallback = useCallback(function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    maxWaitArgs.current = args;\n    clearTimeout(functionTimeoutHandler.current);\n\n    if (leadingCall.current) {\n      leadingCall.current = false;\n    }\n\n    if (!functionTimeoutHandler.current && leading && !leadingCall.current) {\n      debouncedFunction.current.apply(debouncedFunction, args);\n      leadingCall.current = true;\n    }\n\n    functionTimeoutHandler.current = setTimeout(function () {\n      var shouldCallFunction = true;\n\n      if (leading && leadingCall.current) {\n        shouldCallFunction = false;\n      }\n\n      cancelDebouncedCallback();\n\n      if (!isComponentUnmounted.current && trailing && shouldCallFunction) {\n        debouncedFunction.current.apply(debouncedFunction, args);\n      }\n    }, delay);\n\n    if (maxWait && !maxWaitHandler.current && trailing) {\n      maxWaitHandler.current = setTimeout(function () {\n        var args = maxWaitArgs.current;\n        cancelDebouncedCallback();\n\n        if (!isComponentUnmounted.current) {\n          debouncedFunction.current.apply(null, args);\n        }\n      }, maxWait);\n    }\n  }, [maxWait, delay, cancelDebouncedCallback, leading, trailing]);\n  var callPending = useCallback(function () {\n    // Call pending callback only if we have anything in our queue\n    if (!functionTimeoutHandler.current) {\n      return;\n    }\n\n    debouncedFunction.current.apply(null, maxWaitArgs.current);\n    cancelDebouncedCallback();\n  }, [cancelDebouncedCallback]); // At the moment, we use 3 args array so that we save backward compatibility\n\n  return [debouncedCallback, cancelDebouncedCallback, callPending];\n}"],"sourceRoot":""}